---
title: "Tests with PranaGEO R_API"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction
PranaGEO R API engine is a scalable, secure, stateless REST API alowing to make R calls. It is possible to run code that is offered by standart R or in 3rd party R packages that can be easily installed from CRAN, GitHub or similar sources. 

HTML rendering of this document will be deployed online at http://coreos3.pranageo.com/ocpu/apps/pranageo/graphileonR/www/R_API_Examples.html

## Input data
The input data for this demo is accessible (online)[https://github.com/PranaGeo/graphileonR/blob/master/inst/extdata/data.json]. One can download it directly with curl :

```{bash results="hide"}
curl -O https://raw.githubusercontent.com/PranaGeo/graphileonR/master/inst/extdata/data.json
```


or use the getter function *grr_sampledata()*

```{bash results="hide"}
curl -X POST http://coreos3.pranageo.com/ocpu/apps/pranageo/graphileonR/R/grr_sampledata/json
```
y
## Calculating mean values
**Using curl**
```{bash}
curl -X POST -s http://coreos3.pranageo.com/ocpu/apps/pranageo/graphileonR/R/grr_meananalysis/json -F sampledata=@"data.json"
```
**Using R**
```{R}
library(httr)
library(jsonlite)
res <- POST("http://coreos3.pranageo.com/ocpu/apps/pranageo/graphileonR/R/grr_meananalysis/json", body = list(sampledata=upload_file("../extdata/data.json")))
data <- fromJSON(fromJSON(rawToChar(res$content)))
df <- data.frame(hobby=names(data), averages=sapply(data, function(x)x))
df
```

## Plotting results in a pie chart
```{r}
suppressPackageStartupMessages(library(plotly))
plot_ly(data=df, labels=~hobby, values=~averages, type = "pie")
```

